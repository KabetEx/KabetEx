class Post {
  final String id;
  final String userId;
  final String? userFullname;
  final String content;
  final String audience;
  final String year;
  String? avatarUrl;
  final DateTime createdAt; // auto-generated by Supabase

  // Frontend-only fields
  final bool isLiked;
  final int likeCount;

  Post({
    required this.id,
    required this.userId,
    required this.userFullname,
    required this.content,
    required this.audience,
    required this.year,
    required this.createdAt,
    this.avatarUrl = '',
    this.isLiked = false,
    this.likeCount = 0,
  });

  // Fetching from DB
  factory Post.fromMap(Map<String, dynamic> map) => Post(
    id: map['id'],
    userId: map['user_id'],
    content: map['content'],
    audience: map['audience'] ?? 'Everyone',
    year: map['year'] ?? '', //'1st', '2nd', '3rd', '4th',
    userFullname: map['full_name'],
    createdAt: DateTime.parse(map['created_at']),
    avatarUrl: map['avatar_url'] ?? '',
  );

  // Sending to DB
  Map<String, dynamic> toMap() => {
    'id': id,
    'user_id': userId,
    'content': content,
    'full_name': userFullname,
    'audience': audience,
    'year': year,
    'avatar_url': avatarUrl,
  };

  Post copyWith({
    String? id,
    String? userId,
    String? userFullname,
    String? content,
    String? audience,
    String? year,
    DateTime? createdAt,
    bool? isLiked,
    int? likeCount,
    String? avatarUrl,
  }) {
    return Post(
      id: id ?? this.id,
      userId: userId ?? this.userId,
      userFullname: userFullname ?? this.userFullname,
      content: content ?? this.content,
      createdAt: createdAt ?? this.createdAt,
      likeCount: likeCount ?? this.likeCount,
      isLiked: isLiked ?? this.isLiked,
      avatarUrl: avatarUrl ?? this.avatarUrl,
      audience: audience ?? this.audience,
      year: year ?? this.year,
    );
  }
}
